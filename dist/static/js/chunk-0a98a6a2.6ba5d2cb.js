(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0a98a6a2"],{"1e50":function(e,t,n){"use strict";var a=n("50f9"),r=n.n(a);r.a},"42ba":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"createPost-container"},[n("el-form",{ref:"postForm",staticClass:"form-container",attrs:{model:e.postForm,rules:e.rules}},[n("sticky",{attrs:{"z-index":10,"class-name":"sub-navbar "+e.postForm.status}},[n("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"margin-left":"10px"},attrs:{type:"success"},on:{click:e.submitForm}},[e._v("发布")]),e._v(" "),n("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{type:"warning"},on:{click:e.draftForm}},[e._v("草稿")])],1),e._v(" "),n("div",{staticClass:"createPost-main-container"},[n("el-row",[n("Warning"),e._v(" "),n("el-col",{attrs:{span:24}},[n("el-form-item",{staticStyle:{"margin-bottom":"40px"},attrs:{prop:"title"}},[n("MDinput",{attrs:{maxlength:100,name:"name"},model:{value:e.postForm.title,callback:function(t){e.$set(e.postForm,"title",t)},expression:"postForm.title"}},[e._v("标题")])],1),e._v(" "),n("div",{staticClass:"postInfo-container"},[n("el-row",[n("el-col",{attrs:{span:4}},[n("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"90px",prop:"reprint",label:"是否转载:"}},[n("el-switch",{attrs:{"active-value":2,"inactive-value":1},model:{value:e.postForm.reprint,callback:function(t){e.$set(e.postForm,"reprint",t)},expression:"postForm.reprint"}})],1)],1),e._v(" "),2===e.postForm.reprint?n("el-col",{attrs:{span:6}},[n("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"90px",prop:"reprintUrl",label:"转载链接:"}},[n("el-input",{attrs:{rows:2,type:"text",autosize:"",placeholder:"请输入"},model:{value:e.postForm.reprintUrl,callback:function(t){e.$set(e.postForm,"reprintUrl",t)},expression:"postForm.reprintUrl"}})],1)],1):e._e(),e._v(" "),n("el-col",{attrs:{span:6}},[n("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"60px",prop:"classify",label:"分类:"}},[n("el-select",{attrs:{placeholder:"请选择"},model:{value:e.postForm.classify,callback:function(t){e.$set(e.postForm,"classify",t)},expression:"postForm.classify"}},e._l(e.classifyList,(function(e){return n("el-option",{key:e._id,attrs:{label:e.name,value:e._id}})})),1)],1)],1),e._v(" "),n("el-col",{attrs:{span:6}},[n("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"120px",label:"发布时间:"}},[n("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss",placeholder:"请选择"},model:{value:e.postForm.createdAt,callback:function(t){e.$set(e.postForm,"createdAt",t)},expression:"postForm.createdAt"}})],1)],1)],1)],1)],1)],1),e._v(" "),n("el-form-item",{staticStyle:{"margin-bottom":"30px"},attrs:{label:"封面图:","label-width":"70px",prop:"imageUrl"}},[n("Upload",{model:{value:e.postForm.imageUrl,callback:function(t){e.$set(e.postForm,"imageUrl",t)},expression:"postForm.imageUrl"}})],1),e._v(" "),n("el-form-item",{staticStyle:{"margin-bottom":"40px"},attrs:{prop:"outline","label-width":"70px",label:"概述:"}},[n("el-input",{staticClass:"article-textarea",attrs:{rows:1,type:"textarea",autosize:"",placeholder:"请输入"},model:{value:e.postForm.outline,callback:function(t){e.$set(e.postForm,"outline",t)},expression:"postForm.outline"}}),e._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:e.contentShortLength,expression:"contentShortLength"}],staticClass:"word-counter"},[e._v(e._s(e.contentShortLength)+"words")])],1),e._v(" "),n("el-form-item",{staticStyle:{"margin-bottom":"30px"},attrs:{prop:"content"}},[n("mavon-editor",{ref:"md",on:{imgAdd:e.$imgAdd,imgDel:e.$imgDel},model:{value:e.postForm.content,callback:function(t){e.$set(e.postForm,"content",t)},expression:"postForm.content"}})],1)],1)],1)],1)},r=[],i=(n("7f7f"),n("96cf"),n("1da1")),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"singleImageUpload2 upload-container"},[n("el-upload",{staticClass:"image-uploader",attrs:{multiple:!1,"show-file-list":!1,"before-upload":e.beforeUpload,drag:"",action:"https://httpbin.org/post"}},[n("i",{staticClass:"el-icon-upload"}),e._v(" "),n("div",{staticClass:"el-upload__text"},[e._v("\n            将文件拖到此处，或\n            "),n("em",[e._v("点击上传")])])]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.imageUrl.length>0,expression:"imageUrl.length>0"}],staticClass:"image-preview"},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.imageUrl.length>1,expression:"imageUrl.length>1"}],staticClass:"image-preview-wrapper"},[n("img",{attrs:{src:e.imageUrl}}),e._v(" "),n("div",{staticClass:"image-preview-action"},[n("i",{staticClass:"el-icon-delete",on:{click:e.rmImage}})])])])],1)},l=[],o=n("d4ec"),u=n("bee2"),c=n("a78e"),p=n.n(c),d=n("f744"),m=n("b775"),h=function(){function e(){Object(o["a"])(this,e)}return Object(u["a"])(e,[{key:"fetchUploadToken",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=p.a.get("uploadToken"),t){e.next=5;break}return e.next=4,this.updateUploadToken();case 4:t=e.sent;case 5:return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"updateUploadToken",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(m["a"])({url:"/qiniu/upload-token",method:"post"});case 2:return t=e.sent,n=t.data,a=n.uploadToken,p.a.set("uploadToken",a,{expires:new Date((new Date).getTime()+72e5)}),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"qiniuUpload",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t,n){var a,r,i,s,l=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=l.length>2&&void 0!==l[2]?l[2]:{},r=l.length>3&&void 0!==l[3]?l[3]:{},e.next=4,this.fetchUploadToken();case 4:return i=e.sent,s=d["a"](t,n,i,a,r),e.abrupt("return",new Promise((function(e,t){s.subscribe({next:function(e){},error:function(e){t(e)},complete:function(t){t.url="http://qiniu.xiaoying.love/"+t.key,e(t)}})})));case 7:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()}]),e}(),f=new h,v={name:"SingleImageUpload2",props:{value:{type:String,default:""}},data:function(){return{tempUrl:""}},computed:{imageUrl:function(){return this.value}},methods:{rmImage:function(){this.emitInput("")},emitInput:function(e){this.$emit("input",e)},beforeUpload:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.qiniuUpload(t,t.name);case 3:n=e.sent,this.emitInput(n.url),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()}},g=v,b=(n("1e50"),n("2877")),w=Object(b["a"])(g,s,l,!1,null,"3736c8c6",null),y=w.exports,x=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"material-input__component",class:e.computedClasses},[n("div",{class:{iconClass:e.icon}},[e.icon?n("i",{staticClass:"el-input__icon material-input__icon",class:["el-icon-"+e.icon]}):e._e(),e._v(" "),"email"===e.type?n("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autocomplete:e.autoComplete,required:e.required,type:"email"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),"url"===e.type?n("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autocomplete:e.autoComplete,required:e.required,type:"url"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),"number"===e.type?n("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,step:e.step,readonly:e.readonly,disabled:e.disabled,autocomplete:e.autoComplete,max:e.max,min:e.min,minlength:e.minlength,maxlength:e.maxlength,required:e.required,type:"number"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),"password"===e.type?n("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autocomplete:e.autoComplete,max:e.max,min:e.min,required:e.required,type:"password"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),"tel"===e.type?n("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autocomplete:e.autoComplete,required:e.required,type:"tel"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),"text"===e.type?n("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autocomplete:e.autoComplete,minlength:e.minlength,maxlength:e.maxlength,required:e.required,type:"text"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),e._v(" "),n("span",{staticClass:"material-input-bar"}),e._v(" "),n("label",{staticClass:"material-label"},[e._t("default")],2)])])},k=[],_=(n("c5f6"),{name:"MdInput",props:{icon:String,name:String,type:{type:String,default:"text"},value:[String,Number],placeholder:String,readonly:Boolean,disabled:Boolean,min:String,max:String,step:String,minlength:Number,maxlength:Number,required:{type:Boolean,default:!0},autoComplete:{type:String,default:"off"},validateEvent:{type:Boolean,default:!0}},data:function(){return{currentValue:this.value,focus:!1,fillPlaceHolder:null}},computed:{computedClasses:function(){return{"material--active":this.focus,"material--disabled":this.disabled,"material--raised":Boolean(this.focus||this.currentValue)}}},watch:{value:function(e){this.currentValue=e}},methods:{handleModelInput:function(e){var t=e.target.value;this.$emit("input",t),"ElFormItem"===this.$parent.$options.componentName&&this.validateEvent&&this.$parent.$emit("el.form.change",[t]),this.$emit("change",t)},handleMdFocus:function(e){this.focus=!0,this.$emit("focus",e),this.placeholder&&""!==this.placeholder&&(this.fillPlaceHolder=this.placeholder)},handleMdBlur:function(e){this.focus=!1,this.$emit("blur",e),this.fillPlaceHolder=null,"ElFormItem"===this.$parent.$options.componentName&&this.validateEvent&&this.$parent.$emit("el.form.blur",[this.currentValue])}}}),F=_,C=(n("ad53"),Object(b["a"])(F,x,k,!1,null,"d9b004ee",null)),$=C.exports,U=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{style:{height:e.height+"px",zIndex:e.zIndex}},[n("div",{class:e.className,style:{top:e.isSticky?e.stickyTop+"px":"",zIndex:e.zIndex,position:e.position,width:e.width,height:e.height+"px"}},[e._t("default",[n("div",[e._v("sticky")])])],2)])},S=[],R={name:"Sticky",props:{stickyTop:{type:Number,default:0},zIndex:{type:Number,default:1},className:{type:String,default:""}},data:function(){return{active:!1,position:"",width:void 0,height:void 0,isSticky:!1}},mounted:function(){this.height=this.$el.getBoundingClientRect().height,window.addEventListener("scroll",this.handleScroll),window.addEventListener("resize",this.handleResize)},activated:function(){this.handleScroll()},destroyed:function(){window.removeEventListener("scroll",this.handleScroll),window.removeEventListener("resize",this.handleResize)},methods:{sticky:function(){this.active||(this.position="fixed",this.active=!0,this.width=this.width+"px",this.isSticky=!0)},handleReset:function(){this.active&&this.reset()},reset:function(){this.position="",this.width="auto",this.active=!1,this.isSticky=!1},handleScroll:function(){var e=this.$el.getBoundingClientRect().width;this.width=e||"auto";var t=this.$el.getBoundingClientRect().top;t<this.stickyTop?this.sticky():this.handleReset()},handleResize:function(){this.isSticky&&(this.width=this.$el.getBoundingClientRect().width+"px")}}},V=R,I=Object(b["a"])(V,U,S,!1,null,null,null),j=I.exports,M=(n("61f7"),n("2423")),O=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("aside",[e._v("\n  有想法就是实现，有分享就去记录，做个有追求的程序员！\n  ")])},q=[],N={},E=Object(b["a"])(N,O,q,!1,null,null,null),P=E.exports,B=n("52b5"),z=new h,A={issued:1,title:"",classify:"",content:"",outline:"",reprintUrl:"",reprint:1,imageUrl:"",createdAt:Date.now()},D={name:"ArticleDetail",props:{isEdit:{type:Boolean,default:!1}},data:function(){var e=function(e,t,n){""===t?n(new Error(e.field+"为必传项")):n()};return{postForm:Object.assign({},A),loading:!1,rules:{imageUrl:[{validator:e}],title:[{validator:e}],content:[{validator:e}],outline:[{validator:e}],classify:[{validator:e}],reprint:[{validator:e}],reprintUrl:[{required:!0,message:"请输入转载链接",trigger:"blur"}]},classifyList:[]}},computed:{contentShortLength:function(){return this.postForm.outline.length}},created:function(){if(this.isEdit){var e=this.$route.query&&this.$route.query.id;this.fetchData(e)}this.getAllClassify()},methods:{$imgAdd:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t,n){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,z.qiniuUpload(n,n.name);case 3:a=e.sent,this.$refs.md.$img2Url(t,a.url),e.next=10;break;case 7:throw e.prev=7,e.t0=e["catch"](0),e.t0;case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(t,n){return e.apply(this,arguments)}return t}(),$imgDel:function(e,t){console.log(e),console.log(t)},getAllClassify:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(B["c"])();case 3:t=e.sent,n=t.data,this.classifyList=n,e.next=11;break;case 8:throw e.prev=8,e.t0=e["catch"](0),e.t0;case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));function t(){return e.apply(this,arguments)}return t}(),fetchData:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(M["e"])({id:t});case 2:n=e.sent,a=n.data,this.postForm=a;case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),submitForm:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$refs.postForm.validate(function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!n){e.next=21;break}if(t.loading=!0,e.prev=2,!t.isEdit){e.next=8;break}return e.next=6,Object(M["c"])(t.postForm);case 6:e.next=10;break;case 8:return e.next=10,Object(M["a"])(t.postForm);case 10:e.next=16;break;case 12:throw e.prev=12,e.t0=e["catch"](2),t.loading=!1,e.t0;case 16:t.$router.push("/article/article-list"),t.$notify({title:"成功",message:"发布文章成功",type:"success",duration:2e3}),t.loading=!1,e.next=23;break;case 21:return t.$message({message:"请填写必要的选项",type:"warning"}),e.abrupt("return",!1);case 23:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),draftForm:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!==this.postForm.content.length&&0!==this.postForm.title.length){e.next=3;break}return this.$message({message:"请填写必要的标题和内容",type:"warning"}),e.abrupt("return");case 3:return this.postForm.issued=0,e.next=6,this.addArticle();case 6:this.$message({message:"保存成功",type:"success",showClose:!0,duration:1e3});case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},components:{MDinput:$,Sticky:j,Upload:y,Warning:P}},H=D,L=(n("8b96"),Object(b["a"])(H,a,r,!1,null,"0bd0801f",null));t["a"]=L.exports},"50f9":function(e,t,n){},"52b5":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return s}));var a=n("b775");function r(e){return Object(a["a"])({url:"/classify/add-classify",method:"post",data:e})}function i(){return Object(a["a"])({url:"/classify/get-classify-list",method:"get"})}function s(e){return Object(a["a"])({url:"/classify/alter-classify",method:"put",data:e})}},"589d":function(e,t,n){},"7e57":function(e,t,n){},"8b96":function(e,t,n){"use strict";var a=n("7e57"),r=n.n(a);r.a},ad53:function(e,t,n){"use strict";var a=n("589d"),r=n.n(a);r.a}}]);